import"../chunks/DsnmJJEf.js";import"../chunks/CkuBKPka.js";import{b as A,e as f,s as z}from"../chunks/BsuLAxzl.js";import{K as J,I as C,V as x,C as e,J as k,M as K,O as n,P as o,T as i,Q as d,R as v,_ as Q,X}from"../chunks/hUWcfofg.js";import{i as O}from"../chunks/kL-VIWrM.js";import{r as E,s as G}from"../chunks/4kqP-wJn.js";import{b as H}from"../chunks/BmBQcqyL.js";import{b as N}from"../chunks/B5XlLDUz.js";import{i as W}from"../chunks/DtF09Nb2.js";var Y=C('<div class="preview-container svelte-mqw4sl"><img id="img_preview" class="img-preview svelte-mqw4sl" alt="Preview"/></div>'),Z=C(`<div id="filename" class="filename svelte-mqw4sl"> </div> <button id="clear_btn" type="button" class="btn clear_btn svelte-mqw4sl" title="Clear file" aria-label="true"><svg viewBox="0 0 24 24" aria-hidden="true" class="btn-img svelte-mqw4sl" fill="currentColor" width="24" height="24"><path d="M10.59 12L4.54 5.96l1.42-1.42L12 10.59l6.04-6.05
                    1.42 1.42L13.41 12l6.05 6.04-1.42 1.42L12 13.41l-6.04
                    6.05-1.42-1.42L10.59 12z"></path></svg></button>`,1),$=C(`<div class="send-container container svelte-mqw4sl"><form class="send-form svelte-mqw4sl"><div class="send-title svelte-mqw4sl"><p>send your anonymous message</p></div> <input id="text" name="message" type="text" class="send-text svelte-mqw4sl" placeholder="type your message here..."/> <!> <input id="file" name="file" type="file" accept="image/*" class="send-image svelte-mqw4sl" hidden/> <div class="form-buttons flex svelte-mqw4sl"><div class="send-file flex"><button id="file_btn" type="button" class="btn send-file-button svelte-mqw4sl" aria-label="true"><svg viewBox="0 0 24 24" aria-hidden="true" class="btn-img svelte-mqw4sl" fill="currentColor" width="24" height="24"><path d="M3 5.5C3 4.119 4.119 3 5.5 3h13C19.881 3 21 4.119
                         21 5.5v13c0 1.381-1.119 2.5-2.5 2.5h-13C4.119 21
                         3 19.881 3 18.5v-13zM5.5 5c-.276 0-.5.224-.5.5v9.086l3-3
                         3 3 5-5 3 3V5.5c0-.276-.224-.5-.5-.5h-13zM19
                         15.414l-3-3-5 5-3-3-3 3V18.5c0 .276.224.5.5.5h13c.276
                         0 .5-.224.5-.5v-3.086zM9.75 7C8.784 7 8 7.784 8
                         8.75s.784 1.75 1.75 1.75 1.75-.784 1.75-1.75S10.716
                         7 9.75 7z"></path></svg></button> <!></div> <button id="send-button" type="submit" class="btn send-button svelte-mqw4sl"> </button></div></form></div>`);function ee(p,j){J(j,!1);const D="https://auserum.duckdns.org:8443/message";let c=d(""),r=d(null),l=d(""),u=d(!1),m=d();function P(t){const s=t.currentTarget.files?.[0]??null;s?(i(r,s),i(l,URL.createObjectURL(s))):b()}function b(){i(r,null),e(l)&&(URL.revokeObjectURL(e(l)),i(l,"")),e(m)&&Q(m,e(m).value="")}A(()=>{e(l)&&URL.revokeObjectURL(e(l))});async function S(t){if(t.preventDefault(),!e(c).trim()&&!e(r)){alert("Введите сообщение или прикрепите файл.");return}i(u,!0);const a=new FormData;a.append("message",e(c).trim()),e(r)&&a.append("file",e(r));try{const s=await fetch(D,{method:"POST",body:a});if(s.ok)i(c,""),b();else{const L=await s.json();alert("Ошибка от сервера: "+(L.error||"Unknown"))}}catch(s){console.error(s),alert("Произошла ошибка при отправке: "+s?.message)}finally{i(u,!1)}}W();var g=$(),h=o(g),_=n(o(h),2);E(_);var U=n(_,2);{var F=t=>{var a=Y(),s=o(a);v(a),x(()=>G(s,"src",e(l))),k(t,a)};O(U,t=>{e(l)&&t(F)})}var w=n(U,2);N(w,t=>i(m,t),()=>e(m));var R=n(w,2),q=o(R),M=o(q),I=n(M,2);{var T=t=>{var a=Z(),s=X(a),L=o(s,!0);v(s);var B=n(s,2);x(()=>z(L,e(r).name)),f("click",B,b),k(t,a)};O(I,t=>{e(r)&&t(T)})}v(q);var y=n(q,2),V=o(y,!0);v(y),v(R),v(h),v(g),x(()=>{y.disabled=e(u),z(V,e(u)?"sending...":"send")}),H(_,()=>e(c),t=>i(c,t)),f("change",w,P),f("click",M,()=>e(m).click()),f("submit",h,S),k(p,g),K()}function me(p){ee(p,{})}export{me as component};
