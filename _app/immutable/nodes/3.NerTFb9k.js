import"../chunks/DsnmJJEf.js";import"../chunks/CkuBKPka.js";import{o as j,h as N,r as E,e as M,s as Q}from"../chunks/BsuLAxzl.js";import{K as C,W as S,X as $,J as h,M as J,C as t,Q as u,T as n,_ as H,$ as V,I as R,P as O,O as x,R as T,V as W}from"../chunks/hUWcfofg.js";import{i as z}from"../chunks/kL-VIWrM.js";import{r as X}from"../chunks/4kqP-wJn.js";import{b as q}from"../chunks/BmBQcqyL.js";import{b as A}from"../chunks/B5XlLDUz.js";import{p as B}from"../chunks/CdEA5IGF.js";import{i as D}from"../chunks/DtF09Nb2.js";import{g as I}from"../chunks/CdSYgjJX.js";import{b as F}from"../chunks/BRBjtBS7.js";import{s as G}from"../chunks/DqOZeMo_.js";import{S as U}from"../chunks/ClUcPL5X.js";async function Y(){try{return(await fetch("http://localhost:8080/auth/validate",{method:"POST",credentials:"include"})).ok}catch(l){return console.error("Error validating token: "+l),!1}}function Z(l,v){C(v,!1);let s=u(void 0);async function d(){n(s,await Y()),t(s)||I("/?unauthorized")}j(d),D();var c=S(),p=$(c);{var y=o=>{U(o)},e=o=>{var f=S(),a=$(f);{var b=i=>{var m=S(),_=$(m);G(_,v,"default",{}),h(i,m)};z(a,i=>{t(s)&&i(b)},!0)}h(o,f)};z(p,o=>{t(s)===void 0?o(y):o(e,!1)})}h(l,c),J()}var tt=R('<p class="error"> </p>'),et=R('<div class="post-container block"><form class="svelte-137kbop"><button type="submit" class="btn btn-submit svelte-137kbop">Опубликовать</button> <!> <input type="text" placeholder="Заголовок" required class="svelte-137kbop"/> <textarea placeholder="Описание" required class="description block svelte-137kbop"></textarea> <textarea placeholder="Текст поста" required class="content svelte-137kbop"></textarea></form></div>');function vt(l,v){C(v,!1);let s=u(""),d=u(""),c=u(""),p=u(null);async function y(){n(p,null);try{const a=await fetch("http://localhost:8080/admin/articles/create",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:t(s),description:t(d),content:t(c)})});if(!a.ok)throw new Error("Login failed");const b=await a.json();I({base:F}+"/articles?post="+b.uuid)}catch(a){n(p,a.message)}}let e=u(),o;function f(){H(e,t(e).style.height="auto");const a=Math.max(t(e).scrollHeight,o);H(e,t(e).style.height=`${a}px`)}j(()=>{H(e,t(e).style.height="65vh"),o=t(e).clientHeight,f()}),D(),N(a=>{V.title="Админка"}),Z(l,{children:(a,b)=>{var i=et(),m=O(i),_=x(O(m),2);{var K=r=>{var P=tt(),L=O(P,!0);T(P),W(()=>Q(L,t(p))),h(r,P)};z(_,r=>{t(p)&&r(K)})}var k=x(_,2);X(k);var w=x(k,2);E(w);var g=x(w,2);E(g),A(g,r=>n(e,r),()=>t(e)),T(m),T(i),q(k,()=>t(s),r=>n(s,r)),q(w,()=>t(d),r=>n(d,r)),q(g,()=>t(c),r=>n(c,r)),M("input",g,f),M("submit",m,B(y)),h(a,i)},$$slots:{default:!0}}),J()}export{vt as component};
