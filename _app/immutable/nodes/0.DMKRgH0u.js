import{l as Fe,g as Ze,d as Oe,f as w,a as g,i as le,s as A,j as ge,t as _e}from"../chunks/C1dx5bZ-.js";import"../chunks/vpeveaL1.js";import{w as pe,x as Re,aM as De,F as V,b as He,M as ne,aN as Ge,O as he,p as be,u as se,g as v,av as F,k as c,s as m,m as n,t as C,j as ke,R as y,T as ye}from"../chunks/BpNPxeNz.js";import{s as we,i as E,a as Me,b as Ie}from"../chunks/TD4Q2tc6.js";import{i as Ke}from"../chunks/R0fxvOxg.js";import{o as Qe,a as Ue}from"../chunks/CsCwbSxb.js";import{r as me,p as $,s as I,e as We,i as Je}from"../chunks/DwPmcrBK.js";function Xe(e,t,d,_,s){pe&&Re();var i=t.$$slots?.[d],r=!1;i===!0&&(i=t.children,r=!0),i===void 0||i(e,r?()=>_:_)}function fe(e,t,d=t){var _=De(),s=new WeakSet;Fe(e,"input",i=>{var r=i?e.defaultValue:e.value;if(r=ie(e)?oe(r):r,d(r),V!==null&&s.add(V),_&&r!==(r=t())){var f=e.selectionStart,b=e.selectionEnd;e.value=r??"",b!==null&&(e.selectionStart=f,e.selectionEnd=Math.min(b,e.value.length))}}),(pe&&e.defaultValue!==e.value||He(t)==null&&e.value)&&(d(ie(e)?oe(e.value):e.value),V!==null&&s.add(V)),ne(()=>{var i=t();if(e===document.activeElement){var r=Ge??V;if(s.has(r))return}ie(e)&&i===oe(e.value)||e.type==="date"&&!i&&!e.value||i!==e.value&&(e.value=i??"")})}function ie(e){var t=e.type;return t==="number"||t==="range"}function oe(e){return e===""?null:+e}function Ye(e,t,d=t){var _,s,i=()=>{cancelAnimationFrame(_),e.paused||(_=requestAnimationFrame(i));var r=e.currentTime;s!==r&&d(s=r)};_=requestAnimationFrame(i),e.addEventListener("timeupdate",i),ne(()=>{var r=Number(t());s!==r&&!isNaN(r)&&(e.currentTime=s=r)}),he(()=>{cancelAnimationFrame(_),e.removeEventListener("timeupdate",i)})}function ea(e,t,d=t){var _=()=>{d(e.volume)};t()==null&&_(),Ze(e,["volumechange"],_,!1),ne(()=>{var s=Number(t());s!==e.volume&&!isNaN(s)&&(e.volume=s)})}function aa(e,t,d,_,s){var i=()=>{_(d[e])};d.addEventListener(t,i),i(),(d===document.body||d===window||d===document)&&he(()=>{d.removeEventListener(t,i)})}const ta=!0,ra=!1,qa=Object.freeze(Object.defineProperty({__proto__:null,prerender:ta,ssr:ra},Symbol.toStringTag,{value:"Module"}));function la(e,t){y(t,!0)}var sa=w('<audio crossorigin="anonymous"></audio>'),ia=w('<img class="track__cover svelte-mcucg5" alt="cover"/> <div class="track__info svelte-mcucg5"><div class="info__title svelte-mcucg5"> </div> <div class="info__artists svelte-mcucg5"><p class="info__artist svelte-mcucg5"> </p></div></div> <div class="track__time svelte-mcucg5"><time class="audio-progress__current-time svelte-mcucg5"><!></time> <span class="audio-progress__separator svelte-mcucg5">/</span> <time class="audio-progress__total-time svelte-mcucg5"><!></time></div>',1),oa=w('<div class="track__cover svelte-mcucg5"></div>'),na=(e,t)=>t(),ca=ge('<svg class="ctrl-play svelte-mcucg5" color="var(--txt-first)" width="50" height="50" viewBox="0 0 16 16"><path fill="currentColor" d="M5.5 3.5A1.5 1.5 0 0 1 7 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5zm5 0A1.5 1.5 0 0 1 12 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5z"></path></svg>'),va=ge('<svg class="ctrl-play svelte-mcucg5" color="var(--txt-first)" width="50" height="50" viewBox="0 0 16 16"><path fill="currentColor" d="M10.804 8L5 4.633v6.734L10.804 8zm.792-.696a.802.802 0 0 1 0 1.392l-6.363 3.692C4.713 12.69 4 12.345 4 11.692V4.308c0-.653.713-.998 1.233-.696l6.363 3.692z"></path></svg>'),ua=(e,t)=>t(),da=(e,t)=>{e.target===e.currentTarget&&t()},_a=w('<div class="band svelte-mcucg5"><label class="band__label svelte-mcucg5"> </label> <input class="band__slider svelte-mcucg5" type="range" min="0" max="1" step="0.01" value="0.5"/> <span class="band__value svelte-mcucg5"> </span></div>'),ma=w('<div class="eq-overlay svelte-mcucg5"><div class="eq-window svelte-mcucg5" role="dialog" aria-modal="true" aria-label="Equalizer"><button class="eq-close svelte-mcucg5" aria-label="Close equalizer">âœ•</button> <div class="eq-container svelte-mcucg5"><div class="equalizer eq-panel svelte-mcucg5"></div></div></div></div>'),fa=w('<div class="player svelte-mcucg5"><!> <div class="audio-progress svelte-mcucg5"><input type="range" class="audio-progress__slider svelte-mcucg5" min="0" step="0.1"/></div> <div class="player-content svelte-mcucg5"><div class="track-section svelte-mcucg5"><!></div> <div class="controls svelte-mcucg5"><button class="ctrl svelte-mcucg5" aria-label="previous"><svg class="ctrl-icon svelte-mcucg5" color="var(--txt-second)" width="32" height="32" viewBox="0 0 16 16"><path fill="currentColor" d="M2 2.5a.5.5 0 0 1 1 0v11a.5.5 0 0 1-1 0v-11Zm12 .502a1 1 0 0 0-1.579-.816l-7 4.963a1 1 0 0 0-.006 1.628l7 5.037A1 1 0 0 0 14 13.003V3.002ZM6 7.965l7-4.963v10L6 7.966Z"></path></svg></button> <button class="ctrl play svelte-mcucg5"><!></button> <button class="ctrl svelte-mcucg5" aria-label="next"><svg class="ctrl-icon svelte-mcucg5" color="var(--txt-second)" width="32" height="32" viewBox="0 0 16 16"><path fill="currentColor" d="M14 2.5a.5.5 0 1 0-1 0v11a.5.5 0 0 0 1 0v-11ZM2 3.002a1 1 0 0 1 1.579-.816l7 4.963a1 1 0 0 1 .006 1.628l-7 5.037A1 1 0 0 1 2 13.003V3.002Zm8 4.963L3 3.002v10l7-5.037Z"></path></svg></button></div> <div class="volume-section svelte-mcucg5"><button class="volume__btn volume__btn--min svelte-mcucg5" aria-label="Mute"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true" class="svelte-mcucg5"><path d="M11 5v14l-6-6H2V11h3l6-6z" fill="currentColor"></path></svg></button> <input class="volume__slider svelte-mcucg5" type="range" min="0" max="1" step="0.01" aria-label="Volume"/> <button class="volume__btn volume__btn--max svelte-mcucg5" aria-label="Max volume"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true" class="svelte-mcucg5"><path d="M11 5v14l-6-6H2V11h3l6-6z" fill="currentColor"></path><path d="M16.5 8.5a4.5 4.5 0 010 7" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path><path d="M19 6a7 7 0 010 12" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg></button> <button class="ctrl svelte-mcucg5" aria-label="Equalizer"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M3 12h3M10 6h1M14 18h1M7 18h1M20 8h1" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path d="M6 12v5M9 6v11M13 2v15M17 8v10M21 4v14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div></div> <!></div>');function ga(e,t){be(t,!0);const[d,_]=Me(),s=()=>we($,"$playerStore",d),i=[32,64,125,250,500,1e3,2e3,4e3,8e3,16e3];let r=F(null),f=F(0),b=F(0),q=F(.4),p,S,k=[],L=new Array(i.length).fill(0),B=F(!1),Z;function ce(a){if(isNaN(a))return"00:00";const l=Math.floor(a/60).toString().padStart(2,"0"),o=Math.floor(a%60).toString().padStart(2,"0");return`${l}:${o}`}function xe(){$.next()}function Ee(){$.prev()}function K(){y(B,!1)}se(()=>{typeof document<"u"&&(document.body.style.overflow=v(B)?"hidden":"auto")}),se(()=>{v(r)&&s().track&&(s().isPlaying?v(r).play().catch(console.error):v(r).pause())}),se(()=>{if(v(r)&&p&&k.length===0){S=p.createMediaElementSource(v(r));let a=S;i.forEach((l,o)=>{const u=p.createBiquadFilter();u.frequency.value=l,u.Q.value=1,o===0?u.type="lowshelf":o===i.length-1?u.type="highshelf":u.type="peaking",u.gain.value=Math.max(-10,Math.min(10,L[o])),a.connect(u),a=u,k.push(u)}),a.connect(p.destination)}}),Qe(()=>{p=new AudioContext,Z=a=>{a.key==="Escape"&&v(B)&&K()},window.addEventListener("keydown",Z)}),Ue(()=>{p&&p.close(),Z&&window.removeEventListener("keydown",Z)});function qe(a,l){const o=Math.max(-10,Math.min(10,l));L[a]=o,k[a]&&(k[a].gain.value=o)}function Se(a){return(a-.5)*20}var Q=fa(),ve=c(Q);{var je=a=>{var l=sa();Ie(l,o=>y(r,o),()=>v(r)),C(()=>I(l,"src",s().track.audio_url)),le("ended",l,()=>{$.next()}),le("error",l,o=>{const u=o.target;if(u&&u.error){const h=u.error;if(h.code===MediaError.MEDIA_ERR_ABORTED)return;console.error("Audio error:",h.message,"(code:",h.code,")")}else console.error("Unexpected audio error event")}),le("loadeddata",l,()=>{s().isPlaying&&v(r)&&v(r).play().catch(o=>{o.name!=="AbortError"&&console.error("Play error on loadeddata:",o)})}),Ye(l,()=>v(f),o=>y(f,o)),aa("duration","durationchange",l,o=>y(b,o)),ea(l,()=>v(q),o=>y(q,o)),g(a,l)};E(ve,a=>{s().track&&a(je)})}var U=m(ve,2),W=c(U);me(W),n(U);var J=m(U,2),X=c(J),ze=c(X);{var Ae=a=>{var l=ia(),o=ye(l),u=m(o,2),h=c(u),O=c(h,!0);n(h);var R=m(h,2),D=c(R),H=c(D,!0);n(D),n(R),n(u);var j=m(u,2),M=c(j),ae=c(M);{var G=x=>{var T=_e();C(re=>A(T,re),[()=>ce(v(f))]),g(x,T)};E(ae,x=>{v(f)&&x(G)})}n(M);var P=m(M,4),te=c(P);{var z=x=>{var T=_e();C(re=>A(T,re),[()=>ce(v(b))]),g(x,T)};E(te,x=>{v(b)&&x(z)})}n(P),n(j),C(()=>{I(o,"src",s().track.cover_url),A(O,s().track.title),A(H,s().track.artist)}),g(a,l)},Ce=a=>{var l=oa();g(a,l)};E(ze,a=>{s().track?a(Ae):a(Ce,!1)})}n(X);var Y=m(X,2),ue=c(Y);ue.__click=[na,Ee];var N=m(ue,2);N.__click=async()=>{p.state==="suspended"&&await p.resume(),$.togglePlayback()};var $e=c(N);{var Le=a=>{var l=ca();g(a,l)},Be=a=>{var l=va();g(a,l)};E($e,a=>{s().isPlaying?a(Le):a(Be,!1)})}n(N);var Ne=m(N,2);Ne.__click=[ua,xe],n(Y);var de=m(Y,2),ee=m(c(de),2);me(ee);var Pe=m(ee,4);Pe.__click=[la,B],n(de),n(J);var Te=m(J,2);{var Ve=a=>{var l=ma();l.__click=[da,K];var o=c(l),u=c(o);u.__click=K;var h=m(u,2),O=c(h);We(O,21,()=>i,Je,(R,D,H)=>{var j=_a(),M=c(j),ae=c(M,!0);n(M);var G=m(M,2);G.__input=z=>{z.target instanceof HTMLInputElement&&qe(H,Se(parseFloat(z.target.value)))};var P=m(G,2),te=c(P);n(P),n(j),C(z=>{A(ae,v(D)),A(te,`${z??""} dB`)},[()=>L[H].toFixed(1)]),g(R,j)}),n(O),n(h),n(o),n(l),g(a,l)};E(Te,a=>{v(B)&&a(Ve)})}n(Q),C(()=>{I(W,"max",v(b)),I(N,"aria-label",s().isPlaying?"Pause":"Play")}),fe(W,()=>v(f),a=>y(f,a)),fe(ee,()=>v(q),a=>y(q,a)),g(e,Q),ke(),_()}Oe(["click","input"]);var pa=w('<div class="player-reserved svelte-1tv03mj"><!></div>'),ha=w('<aside class="aside svelte-1tv03mj"><div class="aside__column svelte-1tv03mj"><a href="https://t.me/auserum" class="aside__item svelte-1tv03mj" rel="noopener noreferrer" target="_blank" aria-label="true"><i class="bi bi-telegram" style="font-size: 1.875rem; color: #ffffff;"></i></a> <a href="https://bsky.app/profile/nktauserum.bsky.social" class="aside__item svelte-1tv03mj" rel="noopener noreferrer" target="_blank" aria-label="true"><i class="bi bi-bluesky" style="font-size: 1.875rem; color:rgb(255,255,255);"></i></a> <a href="https://github.com/nktauserum" class="aside__item svelte-1tv03mj" rel="noopener noreferrer" target="_blank" aria-label="true"><i class="bi bi-github" style="font-size: 1.875rem; color:rgb(255,255,255);"></i></a></div></aside> <div class="container svelte-1tv03mj"><div class="children svelte-1tv03mj"><!></div> <!></div>',1);function Sa(e,t){be(t,!1);const[d,_]=Me(),s=()=>we($,"$playerStore",d);Ke();var i=ha(),r=m(ye(i),2),f=c(r),b=c(f);Xe(b,t,"default",{}),n(f);var q=m(f,2);{var p=S=>{var k=pa(),L=c(k);ga(L,{}),n(k),g(S,k)};E(q,S=>{s().track&&S(p)})}n(r),g(e,i),ke(),_()}export{Sa as component,qa as universal};
