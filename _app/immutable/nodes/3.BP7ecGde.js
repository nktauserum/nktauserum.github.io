import"../chunks/DsnmJJEf.js";import"../chunks/B_jVOq38.js";import{a as Y,l as G,o as J,e as p,s as z}from"../chunks/C8mEg_6g.js";import{j as R,T as Q,V as X,W as Z,X as $,Y as ee,Z as te,b as se,F as ae,y as h,_ as re,I as le,J as T,L as U,g as s,M as A,N as ne,O as u,P as m,a0 as b,a1 as d,Q as _,a2 as ie,K as oe}from"../chunks/B6oVeRHi.js";import{i as D,b as ve}from"../chunks/H2oftN3p.js";import{i as ce}from"../chunks/GXNgT-5_.js";const de=Symbol("is custom element"),fe=Symbol("is html");function ue(e){if(R){var t=!1,r=()=>{if(!t){if(t=!0,e.hasAttribute("value")){var n=e.value;N(e,"value",null),e.value=n}if(e.hasAttribute("checked")){var a=e.checked;N(e,"checked",null),e.checked=a}}};e.__on_r=r,Q(r),Y()}}function N(e,t,r,n){var a=me(e);R&&(a[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName==="LINK")||a[t]!==(a[t]=r)&&(t==="loading"&&(e[X]=r),r==null?e.removeAttribute(t):typeof r!="string"&&_e(e).includes(t)?e[t]=r:e.setAttribute(t,r))}function me(e){return e.__attributes??={[de]:e.nodeName.includes("-"),[fe]:e.namespaceURI===Z}}var P=new Map;function _e(e){var t=P.get(e.nodeName);if(t)return t;P.set(e.nodeName,t=[]);for(var r,n=e,a=Element.prototype;a!==n;){r=ee(n);for(var l in r)r[l].set&&t.push(l);n=$(n)}return t}function he(e,t,r=t){var n=te(),a=new WeakSet;G(e,"input",l=>{var v=l?e.defaultValue:e.value;if(v=C(e)?E(v):v,r(v),h!==null&&a.add(h),n&&v!==(v=t())){var f=e.selectionStart,g=e.selectionEnd;e.value=v??"",g!==null&&(e.selectionStart=f,e.selectionEnd=Math.min(g,e.value.length))}}),(R&&e.defaultValue!==e.value||se(t)==null&&e.value)&&(r(C(e)?E(e.value):e.value),h!==null&&a.add(h)),ae(()=>{var l=t();if(e===document.activeElement){var v=re??h;if(a.has(v))return}C(e)&&l===E(e.value)||e.type==="date"&&!l&&!e.value||l!==e.value&&(e.value=l??"")})}function C(e){var t=e.type;return t==="number"||t==="range"}function E(e){return e===""?null:+e}var be=T('<div class="preview-container svelte-mqw4sl"><img id="img_preview" class="img-preview svelte-mqw4sl" alt="Preview"/></div>'),ge=T(`<div id="filename" class="filename svelte-mqw4sl"> </div> <button id="clear_btn" type="button" class="btn clear_btn svelte-mqw4sl" title="Clear file" aria-label="true"><svg viewBox="0 0 24 24" aria-hidden="true" class="btn-img svelte-mqw4sl" fill="currentColor" width="24" height="24"><path d="M10.59 12L4.54 5.96l1.42-1.42L12 10.59l6.04-6.05
                    1.42 1.42L13.41 12l6.05 6.04-1.42 1.42L12 13.41l-6.04
                    6.05-1.42-1.42L10.59 12z"></path></svg></button>`,1),pe=T(`<div class="send-container container svelte-mqw4sl"><form class="send-form svelte-mqw4sl"><div class="send-title svelte-mqw4sl"><p>send your anonymous message</p></div> <input id="text" name="message" type="text" class="send-text svelte-mqw4sl" placeholder="type your message here..."/> <!> <input id="file" name="file" type="file" accept="image/*" class="send-image svelte-mqw4sl" hidden/> <div class="form-buttons flex svelte-mqw4sl"><div class="send-file flex"><button id="file_btn" type="button" class="btn send-file-button svelte-mqw4sl" aria-label="true"><svg viewBox="0 0 24 24" aria-hidden="true" class="btn-img svelte-mqw4sl" fill="currentColor" width="24" height="24"><path d="M3 5.5C3 4.119 4.119 3 5.5 3h13C19.881 3 21 4.119
                         21 5.5v13c0 1.381-1.119 2.5-2.5 2.5h-13C4.119 21
                         3 19.881 3 18.5v-13zM5.5 5c-.276 0-.5.224-.5.5v9.086l3-3
                         3 3 5-5 3 3V5.5c0-.276-.224-.5-.5-.5h-13zM19
                         15.414l-3-3-5 5-3-3-3 3V18.5c0 .276.224.5.5.5h13c.276
                         0 .5-.224.5-.5v-3.086zM9.75 7C8.784 7 8 7.784 8
                         8.75s.784 1.75 1.75 1.75 1.75-.784 1.75-1.75S10.716
                         7 9.75 7z"></path></svg></button> <!></div> <button id="send-button" type="submit" class="btn send-button svelte-mqw4sl"> </button></div></form></div>`);function we(e,t){le(t,!1);const r="https://auserum.duckdns.org:8443/message";let n=b(""),a=b(null),l=b(""),v=b(!1),f=b();function g(i){const o=i.currentTarget.files?.[0]??null;o?(d(a,o),d(l,URL.createObjectURL(o))):w()}function w(){d(a,null),s(l)&&(URL.revokeObjectURL(s(l)),d(l,"")),s(f)&&ie(f,s(f).value="")}J(()=>{s(l)&&URL.revokeObjectURL(s(l))});async function V(i){if(i.preventDefault(),!s(n).trim()&&!s(a)){alert("Введите сообщение или прикрепите файл.");return}d(v,!0);const c=new FormData;c.append("message",s(n).trim()),s(a)&&c.append("file",s(a));try{const o=await fetch(r,{method:"POST",body:c});if(o.ok)d(n,""),w();else{const x=await o.json();alert("Ошибка от сервера: "+(x.error||"Unknown"))}}catch(o){console.error(o),alert("Произошла ошибка при отправке: "+o?.message)}finally{d(v,!1)}}ce();var y=pe(),L=m(y),k=u(m(L),2);ue(k);var I=u(k,2);{var F=i=>{var c=be(),o=m(c);_(c),U(()=>N(o,"src",s(l))),A(i,c)};D(I,i=>{s(l)&&i(F)})}var q=u(I,2);ve(q,i=>d(f,i),()=>s(f));var O=u(q,2),M=m(O),j=m(M),B=u(j,2);{var H=i=>{var c=ge(),o=oe(c),x=m(o,!0);_(o);var W=u(o,2);U(()=>z(x,s(a).name)),p("click",W,w),A(i,c)};D(B,i=>{s(a)&&i(H)})}_(M);var S=u(M,2),K=m(S,!0);_(S),_(O),_(L),_(y),U(()=>{S.disabled=s(v),z(K,s(v)?"sending...":"send")}),he(k,()=>s(n),i=>d(n,i)),p("change",q,g),p("click",j,()=>s(f).click()),p("submit",L,V),A(e,y),ne()}function xe(e){we(e,{})}export{xe as component};
